const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./react-vendor-Cd_1bP-5.js","./chakra-ui-C6JwuQmC.js","./vendor-B2h-tn5i.js"])))=>i.map(i=>d[i]);
import{_ as s}from"./index-Dzzf_yyD.js";import{r as e,u as t,i as a,j as r,k as i,V as n,B as o,F as c,A as l,f as m,l as d,M as u,m as h,I as p,n as x,o as j,p as f,q as g,s as y,t as b,v,x as w,y as k,z,D as S}from"./react-vendor-Cd_1bP-5.js";import{f as U,z as _}from"./date-fns-Br9MrKXi.js";import"./chakra-ui-C6JwuQmC.js";import"./vendor-B2h-tn5i.js";const A=m.lazy((()=>s((()=>import("./react-vendor-Cd_1bP-5.js").then((s=>s.E))),__vite__mapDeps([0,1,2]),import.meta.url))),C=()=>{const[s,m]=e.useState([]),[C,D]=e.useState(""),[E,I]=e.useState(!1),R=e.useRef(null),T=t(),H=a("gray.50","gray.700"),O=a("blue.500","blue.400"),V=a("white","gray.600");e.useEffect((()=>{var s;null==(s=R.current)||s.scrollIntoView({behavior:"smooth"})}),[s]);const B=s=>{switch(s){case"sending":return r.jsx(S,{color:"gray"});case"sent":return r.jsx(z,{color:"gray"});case"read":return r.jsx(k,{color:"blue"});default:return null}};return r.jsx(i,{maxW:"container.md",py:4,children:r.jsxs(n,{spacing:4,align:"stretch",h:"calc(100vh - 100px)",children:[r.jsxs(o,{flex:1,overflowY:"auto",p:4,bg:H,borderRadius:"md",children:[s.map(((s,t)=>r.jsxs(c,{justify:s.isUser?"flex-end":"flex-start",mb:4,align:"flex-start",children:[!s.isUser&&r.jsx(l,{name:"AI Assistant",src:"/ai-avatar.png",size:"sm",mr:2}),r.jsxs(o,{maxW:"70%",p:3,borderRadius:"lg",bg:s.isUser?O:V,color:s.isUser?"white":"inherit",boxShadow:"sm",position:"relative",children:[r.jsx(e.Suspense,{fallback:r.jsx("div",{children:"加载中..."}),children:r.jsx(A,{children:s.content})}),r.jsxs(c,{justify:"space-between",align:"center",mt:2,children:[r.jsx(d,{fontSize:"xs",color:s.isUser?"whiteAlpha.700":"gray.500",children:U(s.timestamp,"HH:mm",{locale:_})}),s.isUser&&r.jsx(o,{ml:2,children:B(s.status)})]}),r.jsxs(u,{children:[r.jsx(h,{as:p,icon:r.jsx(x,{}),variant:"ghost",size:"sm",position:"absolute",top:2,right:2,opacity:0,_groupHover:{opacity:1}}),r.jsxs(j,{children:[r.jsx(f,{icon:r.jsx(g,{}),onClick:()=>(async s=>{try{await navigator.clipboard.writeText(s),T({title:"已复制",status:"success",duration:2e3,isClosable:!0})}catch(e){}})(s.content),children:"复制"}),r.jsx(f,{icon:r.jsx(y,{}),onClick:()=>(s=>{m((e=>e.filter(((e,t)=>t!==s))))})(t),children:"删除"})]})]})]}),s.isUser&&r.jsx(l,{name:"User",src:"/user-avatar.png",size:"sm",ml:2})]},t))),r.jsx("div",{ref:R})]}),r.jsx("form",{onSubmit:async s=>{if(s.preventDefault(),!C.trim())return;const e=C.trim();D("");const t={content:e,isUser:!0,timestamp:new Date,status:"sending"};m((s=>[...s,t])),I(!0);try{const s=await fetch("https://api.deepseek.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer sk-e32f9e02b3354fa29af6c160266613da"},body:JSON.stringify({model:"deepseek-chat",messages:[{role:"user",content:e}],temperature:.7,max_tokens:2e3})});if(!s.ok)throw new Error("Network response was not ok");const a=(await s.json()).choices[0].message.content;m((s=>s.map((s=>s===t?{...s,status:"sent"}:s)))),m((s=>[...s,{content:a,isUser:!1,timestamp:new Date,status:"sent"}]))}catch(a){m((s=>s.map((s=>s===t?{...s,status:"sent"}:s)))),T({title:"错误",description:"发送消息时出错，请稍后重试",status:"error",duration:3e3,isClosable:!0})}finally{I(!1)}},children:r.jsxs(c,{children:[r.jsx(b,{value:C,onChange:s=>D(s.target.value),placeholder:"输入消息...",mr:2,size:"lg"}),r.jsx(v,{type:"submit",colorScheme:"blue",isLoading:E,size:"lg",rightIcon:r.jsx(w,{}),children:"发送"})]})})]})})};export{C as default};
